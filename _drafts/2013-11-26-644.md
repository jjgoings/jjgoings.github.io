--- 
layout: post 
title: Thouless Theorem 
---

[caption id="attachment\_657" align="aligncenter" width="300"] [![This cat knows the importance of the exp(T1) operator.]({{ site.baseurl }}/assets/kitty.jpg?w=300)](http://joshuagoings.files.wordpress.com/2013/11/kitty.jpg) This cat knows the importance of the exp(T1) operator.[/caption]

Kind of a dry post today (hey, I put in a cat picture at least)...but I had to share a theorem -- the Thouless theorem -- that is so important in computational and quantum chemistry, and is really quite unknown. It ties together Hartree-Fock, Brillouin's theorem, the successes of coupled cluster, and even some MCSCF ideas. It basically explains why single excitation operators are so important and useful in quantum chemistry, and what they are actually doing when we run our calculations and devise new methods. For someone working closely in electronic structure, it is hard to understate the importance of this theorem. Also the proof is kind of hard to a) find and, b) understand. So I tried to make it simpler and more accessible!

PDF Version (so much, better, trust me): [Thouless\_theorem](http://joshuagoings.files.wordpress.com/2014/03/thouless_theorem.pdf) [  
](http://joshuagoings.files.wordpress.com/2013/11/thouless_theorem.pdf)

The Thouless theorem ( [Thouless, 1960](http://www.sciencedirect.com/science/article/pii/0029558260900481)) says that the effect of the $$ {e^{\hat{T}\_1}}&fg=000000$$ operator is to transform any single determinant into any other single determinant. In other words, we can write  
$$ \displaystyle |\phi\rangle = [\hbox{exp}\left(\sum\limits\_{i=1}^{N}\sum\limits\_{a = N+1}^{\infty} t\_i^a a^{\dagger}\_{a}a\_i\right)]|\phi\_0\rangle \ \ \ \ \ (1)&fg=000000$$  
or  
$$ \displaystyle |\phi\rangle= e^{\hat{T}\_1} |\phi\_0 \rangle \ \ \ \ \ (2)&fg=000000$$

In other words, we can generate any single determinant in terms of another determinant with virtual orbitals (or single excitations) mixed in with it. This is sometimes called ``orbital rotation''. If we minimize the energy of the Slater determinant with respect to the rotation parameters (or $$ {t\_ai}&fg=000000$$ amplitudes), we get the Hartree-Fock wavefunction out. This is the Brillouins condition, and says that the Hartree Fock reference will not interact (directly) with singly excited determinants. And of course it shouldn't! We just variationally optimized with respect to those parameters! The Thouless theorem also explains why there is no such thing as a coupled cluster singles equation (it gives Hartree-Fock back). Now, we do include single excitations in CCSD, but they work themselves in because of correlation generated by higher excitations (Ds or Ts, etc.) The Thouless theorem explains why CCSD and higher methods are so insensitive to reference choice; you generate the optimal reference through the $$ {\hat{T}\_1}&fg=000000$$ operator. I'm sure there are plenty more uses (you see them a lot in MCSCF actually) that exist in the quantum chemistry literature.

Let's say we have a single N-electron Slater determinant, written in second quantization as

$$ \displaystyle |\phi\_0 \rangle = a^{\dagger}\_{1}a^{\dagger}\_{2}\cdots a^{\dagger}\_{N}|0\rangle = \prod\limits\_{i=1}^{N} a^{\dagger}\_{i} |0\rangle \ \ \ \ \ (3)&fg=000000$$

where $$ {N}&fg=000000$$ is the number of electrons in our aptly named N-electron wavefunction, and $$ {|0\rangle}&fg=000000$$ is a vacuum. Let's say we know what this wavefunction $$ {|\phi\_0\rangle}&fg=000000$$ is, which is to say it will be our reference determinant. This might be the result of a Hartree-Fock calculation for example. Now say we want to make a new single determinant $$ {|\phi\rangle}&fg=000000$$ in terms of our reference determinant (I'll use `determinant' and `wavefunction' interchangably). First we write our wavefunction:  
$$ \displaystyle |\phi \rangle = \tilde{a}^{\dagger}\_{1}\tilde{a}^{\dagger}\_{2}\cdots \tilde{a}^{\dagger}\_{N}|0\rangle = \prod\limits\_{\alpha=1}^{N} \tilde{a}^{\dagger}\_{\alpha} |0\rangle \ \ \ \ \ (4)&fg=000000$$

The difference between $$ {a^{\dagger}}&fg=000000$$ and $$ {\tilde{a}^{\dagger}}&fg=000000$$ is simply that they create electrons in different (though not orthonormal) orbitals in our Slater determinant. We will assume that the sets of creation (and corresponding annihilation) operators form complete sets and are non-orthogonal with respect to each other. If this is the case we can write one set in terms of the other like so:  
$$ \displaystyle \tilde{a}^{\dagger}\_{\alpha} = \sum\limits\_{i}^{\infty} u\_{\alpha i} a^{\dagger}\_{i} \ \ \ \ \ (5)&fg=000000$$

This is just a change of basis operation. See, for example, Szabo and Ostlund p13. This suggests that we can write  
$$ \displaystyle |\phi\rangle = \prod\limits\_{\alpha=1}^{N}\tilde{a}^{\dagger}\_{\alpha} |0\rangle = \prod\limits\_{\alpha = 1}^{N} \left(\sum\limits\_{i}^{\infty} u\_{\alpha i} a^{\dagger}\_{i}\right) |0\rangle \ \ \ \ \ (6)&fg=000000$$

Following the presentation of Thouless, we then split the sum over occupied and virtual spaces (with respect to the reference):  
$$ \displaystyle |\phi\rangle = \prod\limits\_{\alpha = 1}^{N} \left(\sum\limits\_{i}^{\infty} u\_{\alpha i} a^{\dagger}\_{i}\right) |0\rangle = \prod\limits\_{\alpha = 1}^{N} \left(\sum\limits\_{i}^{N} u\_{\alpha i} a^{\dagger}\_{i} + \sum\limits\_{m= N + 1}^{\infty} u\_{\alpha m} a^{\dagger}\_{m}\right) |0\rangle \ \ \ \ \ (7)&fg=000000$$

Alright. Since we assumed $$ {|\phi\rangle}&fg=000000$$ and $$ {|\phi\_0\rangle}&fg=000000$$ were not orthogonal, we can choose an intermediate normalization, setting  
$$ \displaystyle \langle \phi\_0 | \phi \rangle = \mathbf{1} \ \ \ \ \ (8)&fg=000000$$

Which further implies (again, check out Szabo and Ostlund p13) that the transformation matrix composed of $$ {u\_{\alpha i}}&fg=000000$$ is unitary when $$ {\alpha}&fg=000000$$ and $$ {i}&fg=000000$$ run from 1 to $$ {N}&fg=000000$$ (remember $$ {u}&fg=000000$$ is actually a rectangular matrix according to our change of basis definition in 5. This means the square $$ {N \times N}&fg=000000$$ subsection of $$ {u}&fg=000000$$ is invertible, and we represent its $$ {N \times N}&fg=000000$$ inverse as $$ {U\_{i\alpha}}&fg=000000$$. Here's another way to look at it, as well as derive some of the properties of $$ {\mathbf{u}}&fg=000000$$ and $$ {\mathbf{U}}&fg=000000$$:  
$$ \displaystyle \mathbf{uU} = \begin{bmatrix} \mathbf{u}\_{(N\times N)} \\ \mathbf{u}\_{N \times (N+1):\infty} \end{bmatrix} \mathbf{U} = \begin{bmatrix} \mathbf{I} \\ \mathbf{T} \end{bmatrix} \ \ \ \ \ (9)&fg=000000$$

where  
$$ \displaystyle \mathbf{u}\_{(N\times N)} \mathbf{U} = \mathbf{I} \qquad \hbox{or} \qquad \sum\limits\_{i=1}^{N} u\_{\alpha i} U\_{i \beta} = \delta\_{\alpha \beta} \ \ \ \ \ (10)&fg=000000$$

and conversely,  
$$ \displaystyle \mathbf{U}\mathbf{u}\_{(N\times N)} = \mathbf{I} \qquad \hbox{or} \qquad \sum\limits\_{\alpha=1}^{N} U\_{i \alpha} u\_{\alpha j} = \delta\_{i j} \ \ \ \ \ (11)&fg=000000$$

and that odd looking $$ {\mathbf{T}}&fg=000000$$ matrix is the result of the parts of $$ {\mathbf{u}}&fg=000000$$ that extend past the number of electrons $$ {N}&fg=000000$$:  
$$ \displaystyle \mathbf{U}\mathbf{u}\_{(N\times (N+1):\infty)} = \mathbf{T} \qquad \hbox{or} \qquad \sum\limits\_{\alpha=1}^{N} U\_{i \alpha} u\_{\alpha m} = t\_{mi} \ \ \ \ \ (12)&fg=000000$$

Where $$ {i\leq N}&fg=000000$$ and $$ {m\>N}&fg=000000$$ for the above equation. Now we put it all together. Because $$ {\mathbf{U}}&fg=000000$$ is unitary, we can write $$ {N}&fg=000000$$ linearly independent combinations of the creation operators, each of which we'll call $$ {\bar{a}^{\dagger}\_i}&fg=000000$$. (Yes, we have now introduced three sets of creation operators, and yes this is essentially what Thouless does, but one of the sets is intermediate to our results and then we will go back to relating two sets. Trust me.)  
$$ \displaystyle \bar{a}\_i^{\dagger} = \sum\limits\_{\alpha =1}^{N} U\_{i \alpha} \tilde{a}\_{\alpha}^{\dagger} \ \ \ \ \ (13)&fg=000000$$

Now the fun happens and using equations 5,10, 11, and 12 we can rewrite the above in terms of just our reference creation and annihilation operators  
$$ \displaystyle \bar{a}\_i^{\dagger} = \sum\limits\_{\alpha =1}^{N} U\_{i \alpha} \tilde{a}\_{\alpha}^{\dagger} \ \ \ \ \ (14)&fg=000000$$

$$ \displaystyle \bar{a}\_i^{\dagger} = \sum\limits\_{\alpha =1}^{N} U\_{i \alpha} \sum\limits\_{j=1}^{\infty} u\_{\alpha j} a\_j^{\dagger} \ \ \ \ \ (15)&fg=000000$$

$$ \displaystyle \bar{a}\_i^{\dagger} = \sum\limits\_{\alpha =1}^{N} U\_{i \alpha} \left( \sum\limits\_{j=1}^{N} u\_{\alpha j} a\_j^{\dagger} + \sum\limits\_{m=N+1}^{\infty} u\_{\alpha m} a\_m^{\dagger}\right) \ \ \ \ \ (16)&fg=000000$$

$$ \displaystyle \bar{a}\_i^{\dagger} = \sum\limits\_{\alpha =1}^{N}\sum\limits\_{j=1}^{N} U\_{i \alpha} u\_{\alpha j} a\_j^{\dagger} + \sum\limits\_{\alpha=1}^{N}\sum\limits\_{m=N+1}^{\infty} U\_{i \alpha} u\_{\alpha m} a\_m^{\dagger} \ \ \ \ \ (17)&fg=000000$$

$$ \displaystyle \bar{a}\_i^{\dagger} = \sum\limits\_{j = 1}^{N} \delta\_{i j} a\_{j}^{\dagger} + \sum\limits\_{m=N+1}^{\infty} t\_{mi} a\_{m}^{\dagger} \ \ \ \ \ (18)&fg=000000$$

$$ \displaystyle \bar{a}\_i^{\dagger} = a\_{i}^{\dagger} + \sum\limits\_{m=N+1}^{\infty} t\_{mi} a\_m^{\dagger} \ \ \ \ \ (19)&fg=000000$$

In other words, any new orbital may be generated by mixing in contributions from virtual orbitals. We apply this to generating any new single determinant below.  
$$ \displaystyle |\psi\rangle = \prod\limits\_i^{N}\tilde{a}\_i^{\dagger} |0\rangle \ \ \ \ \ (20)&fg=000000$$

$$ \displaystyle |\psi\rangle= \prod\limits\_i^{N}\left(a\_{i}^{\dagger} + \sum\limits\_{m=N+1}^{\infty}t\_{mi}a\_m^{\dagger}\right)|0\rangle \ \ \ \ \ (21)&fg=000000$$

$$ \displaystyle |\psi\rangle= \prod\limits\_i^{N}\left(1 + \sum\limits\_{m=N+1}^{\infty}t\_{mi}a\_m^{\dagger}a\_i\right)a\_i^{\dagger}|0\rangle \ \ \ \ \ (22)&fg=000000$$

$$ \displaystyle |\psi\rangle= \prod\limits\_i^{N}\left(1 + \sum\limits\_{m=N+1}^{\infty}t\_{mi}a\_m^{\dagger}a\_i\right)a\_i^{\dagger}|0\rangle \ \ \ \ \ (23)&fg=000000$$

$$ \displaystyle |\psi\rangle= \prod\limits\_i^{N} \prod\limits\_{m=N+1}^{\infty} \left(1 + \sum\limits\_{m=N+1}^{\infty}t\_{mi}a\_m^{\dagger}a\_i\right)|\psi\_0\rangle \ \ \ \ \ (24)&fg=000000$$

$$ \displaystyle |\psi\rangle = e^{\hat{T}\_1} \ \ \ \ \ (25)&fg=000000$$

We got to the second to last step by realizing that $$ {\prod\limits\_i^{N} a\_i^{\dagger} |0\rangle = |\psi\_0\rangle}&fg=000000$$, and $$ {a\_ia\_i|\psi\_0\rangle = 0}&fg=000000$$. The fact that all terms in which the same creation operator occurs more than once is also the reason we can write the infinite product as an exponential.

